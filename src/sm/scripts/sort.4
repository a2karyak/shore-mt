# --------------------------------------------------------------- #
# -- Copyright (c) 1994, 1995 Computer Sciences Department,    -- #
# -- University of Wisconsin-Madison, subject to the terms     -- #
# -- and conditions given in the file COPYRIGHT.  All Rights   -- #
# -- Reserved.                                                 -- #
# --------------------------------------------------------------- #

#
#	Test sort on integers
#
source $script_dir/vol.init

set nrec 40

set pattern_block ".123456789"
set pattern ""
for {set i 0} {$i < 900} {incr i} {
    set pattern $pattern$pattern_block
    #echo $pattern
}

#create and load a file with integers in reverse order
sm begin_xct
set f1 [sm create_file $volid]
echo f1 = $f1
for {set i 0} {$i < $nrec} {incr i} {
   sm create_sort_rec $f1 [expr { $nrec - $i }] 4 $pattern int
}
echo scans on f1...
#echo [sm scan_sorted_recs $f1 int]
sm commit_xct

#sort and display (non-destructive)
sm begin_xct
echo sort ...
set f2 [sm sort_file $f1 $volid 3 int 4 distinct keep]
echo f2 = $f2

echo scans on f2 ...
echo [sm scan_sorted_recs $f2 int]

#sort and display (destructive)
echo sort ...
set f3 [sm sort_file $f1 $volid 3 int 4 distinct destruct]
echo f3 = $f3

echo scans on f3 ...
echo [sm scan_sorted_recs $f3 int]

#sm destroy_file $f1
#sm destroy_file $f2
#sm destroy_file $f3

sm commit_xct

unset nrec f1 f2 f3 pattern pattern_block i
